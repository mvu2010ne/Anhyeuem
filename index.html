<!DOCTYPE html>
<html lang="vi">
<head>
  <meta charset="UTF-8">
  <title>Không gian tình yêu 3D ❤️</title>
  <style>
    html, body {
      margin: 0;
      overflow: hidden;
      height: 100%;
    }

    body {
      background: url('nen.jpg') no-repeat center center fixed;
      background-size: cover;
    }

    #playBtn {
      position: absolute;
      top: 20px;
      left: 20px;
      z-index: 10;
      background: rgba(255, 255, 255, 0.2);
      color: white;
      border: none;
      padding: 10px 20px;
      font-size: 16px;
      border-radius: 8px;
      cursor: pointer;
    }

    .heart {
      position: fixed;
      top: -30px;
      font-size: 20px;
      user-select: none;
      pointer-events: none;
      animation: fall linear infinite, colorChange 2s infinite alternate;
      z-index: 9;
    }

    @keyframes fall {
      to {
        transform: translateY(110vh);
        opacity: 0;
      }
    }

    @keyframes colorChange {
      0%   { color: #ff4d4d; }
      25%  { color: #4dd2ff; }
      50%  { color: #85e085; }
      75%  { color: #ffcc00; }
      100% { color: #d966ff; }
    }

    canvas {
      position: absolute;
      top: 0;
      left: 0;
      z-index: 5;
    }
  </style>
</head>
<body>

<button id="playBtn">▶️ Phát nhạc</button>
<audio id="bgm" loop>
  <source src="nhac1.mp3" type="audio/mp3">
</audio>

<script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/0.152.2/three.min.js"></script>
<script src="https://threejs.org/examples/js/controls/TrackballControls.js"></script>

<script>
  const messages = [
    "Em là tất cả 💕", "Yêu em nhiều lắm 😘", "Chỉ cần em là đủ", "Mãi bên nhau 💖",
    "Anh yêu em 💗", "Luôn nhớ em 🌹", "Em là định mệnh", "Anh Yeu Ebe Cua Anh Nhiu💗"
  ];

  const imagePaths = ["1.jpg", "2.jpg", "3.jpg", "4.jpg", "5.jpg"];
  const loader = new THREE.TextureLoader();

  // Khởi tạo scene
  const scene = new THREE.Scene();
  const camera = new THREE.PerspectiveCamera(75, window.innerWidth/window.innerHeight, 0.1, 2000);
  camera.position.z = 400;

  const renderer = new THREE.WebGLRenderer({ antialias: true, alpha: true });
  renderer.setSize(window.innerWidth, window.innerHeight);
  renderer.setClearColor(0x000000, 0); // Transparent background
  document.body.appendChild(renderer.domElement);

  // Điều khiển xoay
  const controls = new THREE.TrackballControls(camera, renderer.domElement);
  controls.rotateSpeed = 2.0;
  controls.zoomSpeed = 1.2;
  controls.panSpeed = 0.8;

  // Tải font và tạo chữ 3D
  const fontLoader = new THREE.FontLoader();
  fontLoader.load('https://threejs.org/examples/fonts/helvetiker_bold.typeface.json', function(font) {
    for (let i = 0; i < 50; i++) {
      const textGeo = new THREE.TextGeometry(messages[Math.floor(Math.random() * messages.length)], {
        font: font,
        size: 16,
        height: 1,
        curveSegments: 12,
      });
      const material = new THREE.MeshBasicMaterial({ color: Math.random() * 0xffffff });
      const textMesh = new THREE.Mesh(textGeo, material);

      textMesh.position.x = (Math.random() - 0.5) * 1000;
      textMesh.position.y = (Math.random() - 0.5) * 1000;
      textMesh.position.z = (Math.random() - 0.5) * 1000;

      scene.add(textMesh);
    }
  });

  // Thêm ảnh nổi bay
  imagePaths.forEach((img) => {
    loader.load(img, (texture) => {
      const geometry = new THREE.PlaneGeometry(60, 80);
      const material = new THREE.MeshBasicMaterial({ map: texture, transparent: true });
      for (let i = 0; i < 5; i++) {
        const mesh = new THREE.Mesh(geometry, material);
        mesh.position.set(
          (Math.random() - 0.5) * 1000,
          (Math.random() - 0.5) * 1000,
          (Math.random() - 0.5) * 1000
        );
        scene.add(mesh);
      }
    });
  });

  // Animate scene
  function animate() {
    requestAnimationFrame(animate);
    controls.update();
    renderer.render(scene, camera);
  }
  animate();

  // Resize responsive
  window.addEventListener('resize', () => {
    camera.aspect = window.innerWidth/window.innerHeight;
    camera.updateProjectionMatrix();
    renderer.setSize(window.innerWidth, window.innerHeight);
    controls.handleResize();
  });

  // Nhạc
  const audio = document.getElementById("bgm");
  const btn = document.getElementById("playBtn");
  btn.onclick = () => {
    audio.play();
    btn.remove();
  };

  // Trái tim rơi đổi màu
  function createHeart() {
    const heart = document.createElement("div");
    heart.className = "heart";
    heart.textContent = "❤";
    heart.style.left = Math.random() * window.innerWidth + "px";
    heart.style.fontSize = (16 + Math.random() * 24) + "px";
    heart.style.animationDuration = (3 + Math.random() * 3) + "s";
    document.body.appendChild(heart);
    setTimeout(() => heart.remove(), 6000);
  }

  setInterval(createHeart, 200);
</script>

</body>
</html>